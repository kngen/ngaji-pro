<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Ngaji Pro</title>

    <!-- ===== PWA META TAGS ===== -->
    <meta name="application-name" content="Ngaji Pro">
    <meta name="description" content="Aplikasi Tahfidh, Setoran & Absensi Harian">
    <meta name="theme-color" content="#0b4e2e">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ngaji Pro">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiI+CiAgPGRlZnM+CiAgICA8IS0tIEJhY2tncm91bmQgZ3JhZGllbnQgLS0+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImJnR3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwYTNkMjI7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6IzFhNmIzYTtzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICA8IS0tIEdvbGQgZ3JhZGllbnQgLS0+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImdvbGRHcmFkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNmOWUwN2E7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iNTAlIiBzdHlsZT0ic3RvcC1jb2xvcjojZTZiODMwO3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNjODkwMTA7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPCEtLSBXaGl0ZSBnbG93IC0tPgogICAgPGZpbHRlciBpZD0iZ2xvdyI+CiAgICAgIDxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjMiIHJlc3VsdD0iY29sb3JlZEJsdXIiLz4KICAgICAgPGZlTWVyZ2U+CiAgICAgICAgPGZlTWVyZ2VOb2RlIGluPSJjb2xvcmVkQmx1ciIvPgogICAgICAgIDxmZU1lcmdlTm9kZSBpbj0iU291cmNlR3JhcGhpYyIvPgogICAgICA8L2ZlTWVyZ2U+CiAgICA8L2ZpbHRlcj4KICAgIDwhLS0gU29mdCBzaGFkb3cgLS0+CiAgICA8ZmlsdGVyIGlkPSJzaGFkb3ciPgogICAgICA8ZmVEcm9wU2hhZG93IGR4PSIwIiBkeT0iNCIgc3RkRGV2aWF0aW9uPSI2IiBmbG9vZC1jb2xvcj0iIzAwMDAwMCIgZmxvb2Qtb3BhY2l0eT0iMC4zIi8+CiAgICA8L2ZpbHRlcj4KICA8L2RlZnM+CgogIDwhLS0gQmFja2dyb3VuZCByb3VuZGVkIHJlY3QgLS0+CiAgPHJlY3Qgd2lkdGg9IjUxMiIgaGVpZ2h0PSI1MTIiIHJ4PSIxMDAiIHJ5PSIxMDAiIGZpbGw9InVybCgjYmdHcmFkKSIvPgoKICA8IS0tIFN1YnRsZSBnZW9tZXRyaWMgcGF0dGVybiBvdmVybGF5IC0tPgogIDxnIG9wYWNpdHk9IjAuMDciPgogICAgPGNpcmNsZSBjeD0iMjU2IiBjeT0iMjU2IiByPSIyMDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPGNpcmNsZSBjeD0iMjU2IiBjeT0iMjU2IiByPSIxNjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPGNpcmNsZSBjeD0iMjU2IiBjeT0iMjU2IiByPSIxMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPCEtLSA4LXBvaW50IHN0YXIgcGF0dGVybiAtLT4KICAgIDxwb2x5Z29uIHBvaW50cz0iMjU2LDU2IDI3NiwyMzYgNDU2LDI1NiAyNzYsMjc2IDI1Niw0NTYgMjM2LDI3NiA1NiwyNTYgMjM2LDIzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIwLjgiLz4KICA8L2c+CgogIDwhLS0gPT09PT0gTUFTSklEIC8gTU9TUVVFID09PT09IC0tPgogIDxnIGZpbHRlcj0idXJsKCNzaGFkb3cpIj4KCiAgICA8IS0tIE1haW4gZG9tZSAoa3ViYWggdXRhbWEpIC0tPgogICAgPGVsbGlwc2UgY3g9IjI1NiIgY3k9IjE5NSIgcng9IjcyIiByeT0iNjgiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8cmVjdCB4PSIxODQiIHk9IjE5MyIgd2lkdGg9IjE0NCIgaGVpZ2h0PSIxMCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgICA8IS0tIENyZXNjZW50IG9uIHRvcCBvZiBtYWluIGRvbWUgLS0+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTYsIDE0MCkiPgogICAgICA8IS0tIENyZXNjZW50IG1vb24gLS0+CiAgICAgIDxjaXJjbGUgY3g9IjAiIGN5PSIwIiByPSIxNiIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgICAgPGNpcmNsZSBjeD0iOCIgY3k9Ii00IiByPSIxMyIgZmlsbD0iIzBhM2QyMiIvPgogICAgICA8IS0tIFN0YXIgLS0+CiAgICAgIDxwb2x5Z29uIHBvaW50cz0iMjIsLTE0IDI0LC04IDMwLC04IDI1LC00IDI3LDIgMjIsLTIgMTcsMiAxOSwtNCAxNCwtOCAyMCwtOCIKICAgICAgICAgICAgICAgZmlsbD0idXJsKCNnb2xkR3JhZCkiIHRyYW5zZm9ybT0ic2NhbGUoMC43KSIvPgogICAgPC9nPgoKICAgIDwhLS0gU2lkZSBkb21lcyAoa3ViYWgga2VjaWwga2lyaSAmIGthbmFuKSAtLT4KICAgIDwhLS0gTGVmdCBkb21lIC0tPgogICAgPGVsbGlwc2UgY3g9IjE3OCIgY3k9IjIzMCIgcng9IjM4IiByeT0iMzQiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8cmVjdCB4PSIxNDAiIHk9IjIyOCIgd2lkdGg9Ijc2IiBoZWlnaHQ9IjgiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8IS0tIExlZnQgY3Jlc2NlbnQgLS0+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzgsIDIwMCkiPgogICAgICA8Y2lyY2xlIGN4PSIwIiBjeT0iMCIgcj0iOCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgICAgPGNpcmNsZSBjeD0iNCIgY3k9Ii0yIiByPSI2LjUiIGZpbGw9IiMwYTNkMjIiLz4KICAgIDwvZz4KCiAgICA8IS0tIFJpZ2h0IGRvbWUgLS0+CiAgICA8ZWxsaXBzZSBjeD0iMzM0IiBjeT0iMjMwIiByeD0iMzgiIHJ5PSIzNCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgIDxyZWN0IHg9IjI5NiIgeT0iMjI4IiB3aWR0aD0iNzYiIGhlaWdodD0iOCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgIDwhLS0gUmlnaHQgY3Jlc2NlbnQgLS0+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMzQsIDIwMCkiPgogICAgICA8Y2lyY2xlIGN4PSIwIiBjeT0iMCIgcj0iOCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgICAgPGNpcmNsZSBjeD0iNCIgY3k9Ii0yIiByPSI2LjUiIGZpbGw9IiMwYTNkMjIiLz4KICAgIDwvZz4KCiAgICA8IS0tIE1haW4gYnVpbGRpbmcgYm9keSAtLT4KICAgIDxyZWN0IHg9IjE2MCIgeT0iMjM2IiB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEwMCIgcng9IjQiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CgogICAgPCEtLSBMZWZ0IHdpbmcgLS0+CiAgICA8cmVjdCB4PSIxMjAiIHk9IjI1NiIgd2lkdGg9IjQ0IiBoZWlnaHQ9IjgwIiByeD0iNCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgICA8IS0tIFJpZ2h0IHdpbmcgLS0+CiAgICA8cmVjdCB4PSIzNDgiIHk9IjI1NiIgd2lkdGg9IjQ0IiBoZWlnaHQ9IjgwIiByeD0iNCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgICA8IS0tIE1haW4gYXJjaCAvIGRvb3IgKG1paHJhYikgLS0+CiAgICA8cGF0aCBkPSJNMjI4LDMzNiBMMjI4LDI4NSBRMjU2LDI2NSAyODQsMjg1IEwyODQsMzM2IFoiIGZpbGw9IiMwYTNkMjIiLz4KCiAgICA8IS0tIFNpZGUgYXJjaGVzIG9uIG1haW4gYm9keSAtLT4KICAgIDxwYXRoIGQ9Ik0xNzQsMzM2IEwxNzQsMjc1IFExOTEsMjYyIDIwOCwyNzUgTDIwOCwzMzYgWiIgZmlsbD0iIzBhM2QyMiIvPgogICAgPHBhdGggZD0iTTMwNCwzMzYgTDMwNCwyNzUgUTMyMSwyNjIgMzM4LDI3NSBMMzM4LDMzNiBaIiBmaWxsPSIjMGEzZDIyIi8+CgogICAgPCEtLSBMZWZ0IHdpbmcgYXJjaCAtLT4KICAgIDxwYXRoIGQ9Ik0xMzAsMzM2IEwxMzAsMjgzIFExNDIsMjcyIDE1NCwyODMgTDE1NCwzMzYgWiIgZmlsbD0iIzBhM2QyMiIvPgoKICAgIDwhLS0gUmlnaHQgd2luZyBhcmNoIC0tPgogICAgPHBhdGggZD0iTTM1OCwzMzYgTDM1OCwyODMgUTM3MCwyNzIgMzgyLDI4MyBMMzgyLDMzNiBaIiBmaWxsPSIjMGEzZDIyIi8+CgogICAgPCEtLSBHcm91bmQgLyBiYXNlIGxpbmUgLS0+CiAgICA8cmVjdCB4PSIxMDAiIHk9IjMzNCIgd2lkdGg9IjMxMiIgaGVpZ2h0PSIxMiIgcng9IjYiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CgogICAgPCEtLSBNaW5hcmV0cyAobWVuYXJhKSBraXJpICYga2FuYW4gLS0+CiAgICA8IS0tIExlZnQgbWluYXJldCAtLT4KICAgIDxyZWN0IHg9Ijk2IiB5PSIyMDAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIxMzYiIHJ4PSI0IiBmaWxsPSJ1cmwoI2dvbGRHcmFkKSIvPgogICAgPGVsbGlwc2UgY3g9IjEwOCIgY3k9IjE5OCIgcng9IjE2IiByeT0iMTAiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8cGF0aCBkPSJNMTAwLDE5OCBRMTA4LDE3OCAxMTYsMTk4IFoiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8IS0tIFJpZ2h0IG1pbmFyZXQgLS0+CiAgICA8cmVjdCB4PSIzOTIiIHk9IjIwMCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjEzNiIgcng9IjQiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8ZWxsaXBzZSBjeD0iNDA0IiBjeT0iMTk4IiByeD0iMTYiIHJ5PSIxMCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgIDxwYXRoIGQ9Ik0zOTYsMTk4IFE0MDQsMTc4IDQxMiwxOTggWiIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgPC9nPgoKICA8IS0tID09PT09IFRFWFQgIk5HQUpJIFBSTyIgPT09PT0gLS0+CiAgPHRleHQgeD0iMjU2IiB5PSI0MDAiCiAgICAgICAgZm9udC1mYW1pbHk9Ikdlb3JnaWEsICdUaW1lcyBOZXcgUm9tYW4nLCBzZXJpZiIKICAgICAgICBmb250LXNpemU9IjUyIgogICAgICAgIGZvbnQtd2VpZ2h0PSI3MDAiCiAgICAgICAgbGV0dGVyLXNwYWNpbmc9IjIiCiAgICAgICAgdGV4dC1hbmNob3I9Im1pZGRsZSIKICAgICAgICBmaWxsPSJ1cmwoI2dvbGRHcmFkKSIKICAgICAgICBmaWx0ZXI9InVybCgjZ2xvdykiPk5HQUpJIFBSTzwvdGV4dD4KCiAgPCEtLSBEZWNvcmF0aXZlIGxpbmUgdW5kZXIgdGV4dCAtLT4KICA8bGluZSB4MT0iMTU2IiB5MT0iNDEyIiB4Mj0iMzU2IiB5Mj0iNDEyIiBzdHJva2U9InVybCgjZ29sZEdyYWQpIiBzdHJva2Utd2lkdGg9IjIiIG9wYWNpdHk9IjAuNiIvPgoKICA8IS0tIFRhZ2xpbmUgLS0+CiAgPHRleHQgeD0iMjU2IiB5PSI0NDAiCiAgICAgICAgZm9udC1mYW1pbHk9Ikdlb3JnaWEsIHNlcmlmIgogICAgICAgIGZvbnQtc2l6ZT0iMjAiCiAgICAgICAgbGV0dGVyLXNwYWNpbmc9IjMiCiAgICAgICAgdGV4dC1hbmNob3I9Im1pZGRsZSIKICAgICAgICBmaWxsPSIjZjllMDdhIgogICAgICAgIG9wYWNpdHk9IjAuNzUiPlRBSEZJREgg4oCiIEFCU0VOU0k8L3RleHQ+Cgo8L3N2Zz4K">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiI+CiAgPGRlZnM+CiAgICA8IS0tIEJhY2tncm91bmQgZ3JhZGllbnQgLS0+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImJnR3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwYTNkMjI7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6IzFhNmIzYTtzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICA8IS0tIEdvbGQgZ3JhZGllbnQgLS0+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImdvbGRHcmFkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNmOWUwN2E7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iNTAlIiBzdHlsZT0ic3RvcC1jb2xvcjojZTZiODMwO3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNjODkwMTA7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPCEtLSBXaGl0ZSBnbG93IC0tPgogICAgPGZpbHRlciBpZD0iZ2xvdyI+CiAgICAgIDxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjMiIHJlc3VsdD0iY29sb3JlZEJsdXIiLz4KICAgICAgPGZlTWVyZ2U+CiAgICAgICAgPGZlTWVyZ2VOb2RlIGluPSJjb2xvcmVkQmx1ciIvPgogICAgICAgIDxmZU1lcmdlTm9kZSBpbj0iU291cmNlR3JhcGhpYyIvPgogICAgICA8L2ZlTWVyZ2U+CiAgICA8L2ZpbHRlcj4KICAgIDwhLS0gU29mdCBzaGFkb3cgLS0+CiAgICA8ZmlsdGVyIGlkPSJzaGFkb3ciPgogICAgICA8ZmVEcm9wU2hhZG93IGR4PSIwIiBkeT0iNCIgc3RkRGV2aWF0aW9uPSI2IiBmbG9vZC1jb2xvcj0iIzAwMDAwMCIgZmxvb2Qtb3BhY2l0eT0iMC4zIi8+CiAgICA8L2ZpbHRlcj4KICA8L2RlZnM+CgogIDwhLS0gQmFja2dyb3VuZCByb3VuZGVkIHJlY3QgLS0+CiAgPHJlY3Qgd2lkdGg9IjUxMiIgaGVpZ2h0PSI1MTIiIHJ4PSIxMDAiIHJ5PSIxMDAiIGZpbGw9InVybCgjYmdHcmFkKSIvPgoKICA8IS0tIFN1YnRsZSBnZW9tZXRyaWMgcGF0dGVybiBvdmVybGF5IC0tPgogIDxnIG9wYWNpdHk9IjAuMDciPgogICAgPGNpcmNsZSBjeD0iMjU2IiBjeT0iMjU2IiByPSIyMDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPGNpcmNsZSBjeD0iMjU2IiBjeT0iMjU2IiByPSIxNjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPGNpcmNsZSBjeD0iMjU2IiBjeT0iMjU2IiByPSIxMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPCEtLSA4LXBvaW50IHN0YXIgcGF0dGVybiAtLT4KICAgIDxwb2x5Z29uIHBvaW50cz0iMjU2LDU2IDI3NiwyMzYgNDU2LDI1NiAyNzYsMjc2IDI1Niw0NTYgMjM2LDI3NiA1NiwyNTYgMjM2LDIzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIwLjgiLz4KICA8L2c+CgogIDwhLS0gPT09PT0gTUFTSklEIC8gTU9TUVVFID09PT09IC0tPgogIDxnIGZpbHRlcj0idXJsKCNzaGFkb3cpIj4KCiAgICA8IS0tIE1haW4gZG9tZSAoa3ViYWggdXRhbWEpIC0tPgogICAgPGVsbGlwc2UgY3g9IjI1NiIgY3k9IjE5NSIgcng9IjcyIiByeT0iNjgiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8cmVjdCB4PSIxODQiIHk9IjE5MyIgd2lkdGg9IjE0NCIgaGVpZ2h0PSIxMCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgICA8IS0tIENyZXNjZW50IG9uIHRvcCBvZiBtYWluIGRvbWUgLS0+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTYsIDE0MCkiPgogICAgICA8IS0tIENyZXNjZW50IG1vb24gLS0+CiAgICAgIDxjaXJjbGUgY3g9IjAiIGN5PSIwIiByPSIxNiIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgICAgPGNpcmNsZSBjeD0iOCIgY3k9Ii00IiByPSIxMyIgZmlsbD0iIzBhM2QyMiIvPgogICAgICA8IS0tIFN0YXIgLS0+CiAgICAgIDxwb2x5Z29uIHBvaW50cz0iMjIsLTE0IDI0LC04IDMwLC04IDI1LC00IDI3LDIgMjIsLTIgMTcsMiAxOSwtNCAxNCwtOCAyMCwtOCIKICAgICAgICAgICAgICAgZmlsbD0idXJsKCNnb2xkR3JhZCkiIHRyYW5zZm9ybT0ic2NhbGUoMC43KSIvPgogICAgPC9nPgoKICAgIDwhLS0gU2lkZSBkb21lcyAoa3ViYWgga2VjaWwga2lyaSAmIGthbmFuKSAtLT4KICAgIDwhLS0gTGVmdCBkb21lIC0tPgogICAgPGVsbGlwc2UgY3g9IjE3OCIgY3k9IjIzMCIgcng9IjM4IiByeT0iMzQiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8cmVjdCB4PSIxNDAiIHk9IjIyOCIgd2lkdGg9Ijc2IiBoZWlnaHQ9IjgiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8IS0tIExlZnQgY3Jlc2NlbnQgLS0+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzgsIDIwMCkiPgogICAgICA8Y2lyY2xlIGN4PSIwIiBjeT0iMCIgcj0iOCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgICAgPGNpcmNsZSBjeD0iNCIgY3k9Ii0yIiByPSI2LjUiIGZpbGw9IiMwYTNkMjIiLz4KICAgIDwvZz4KCiAgICA8IS0tIFJpZ2h0IGRvbWUgLS0+CiAgICA8ZWxsaXBzZSBjeD0iMzM0IiBjeT0iMjMwIiByeD0iMzgiIHJ5PSIzNCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgIDxyZWN0IHg9IjI5NiIgeT0iMjI4IiB3aWR0aD0iNzYiIGhlaWdodD0iOCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgIDwhLS0gUmlnaHQgY3Jlc2NlbnQgLS0+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMzQsIDIwMCkiPgogICAgICA8Y2lyY2xlIGN4PSIwIiBjeT0iMCIgcj0iOCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgICAgPGNpcmNsZSBjeD0iNCIgY3k9Ii0yIiByPSI2LjUiIGZpbGw9IiMwYTNkMjIiLz4KICAgIDwvZz4KCiAgICA8IS0tIE1haW4gYnVpbGRpbmcgYm9keSAtLT4KICAgIDxyZWN0IHg9IjE2MCIgeT0iMjM2IiB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEwMCIgcng9IjQiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CgogICAgPCEtLSBMZWZ0IHdpbmcgLS0+CiAgICA8cmVjdCB4PSIxMjAiIHk9IjI1NiIgd2lkdGg9IjQ0IiBoZWlnaHQ9IjgwIiByeD0iNCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgICA8IS0tIFJpZ2h0IHdpbmcgLS0+CiAgICA8cmVjdCB4PSIzNDgiIHk9IjI1NiIgd2lkdGg9IjQ0IiBoZWlnaHQ9IjgwIiByeD0iNCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgICA8IS0tIE1haW4gYXJjaCAvIGRvb3IgKG1paHJhYikgLS0+CiAgICA8cGF0aCBkPSJNMjI4LDMzNiBMMjI4LDI4NSBRMjU2LDI2NSAyODQsMjg1IEwyODQsMzM2IFoiIGZpbGw9IiMwYTNkMjIiLz4KCiAgICA8IS0tIFNpZGUgYXJjaGVzIG9uIG1haW4gYm9keSAtLT4KICAgIDxwYXRoIGQ9Ik0xNzQsMzM2IEwxNzQsMjc1IFExOTEsMjYyIDIwOCwyNzUgTDIwOCwzMzYgWiIgZmlsbD0iIzBhM2QyMiIvPgogICAgPHBhdGggZD0iTTMwNCwzMzYgTDMwNCwyNzUgUTMyMSwyNjIgMzM4LDI3NSBMMzM4LDMzNiBaIiBmaWxsPSIjMGEzZDIyIi8+CgogICAgPCEtLSBMZWZ0IHdpbmcgYXJjaCAtLT4KICAgIDxwYXRoIGQ9Ik0xMzAsMzM2IEwxMzAsMjgzIFExNDIsMjcyIDE1NCwyODMgTDE1NCwzMzYgWiIgZmlsbD0iIzBhM2QyMiIvPgoKICAgIDwhLS0gUmlnaHQgd2luZyBhcmNoIC0tPgogICAgPHBhdGggZD0iTTM1OCwzMzYgTDM1OCwyODMgUTM3MCwyNzIgMzgyLDI4MyBMMzgyLDMzNiBaIiBmaWxsPSIjMGEzZDIyIi8+CgogICAgPCEtLSBHcm91bmQgLyBiYXNlIGxpbmUgLS0+CiAgICA8cmVjdCB4PSIxMDAiIHk9IjMzNCIgd2lkdGg9IjMxMiIgaGVpZ2h0PSIxMiIgcng9IjYiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CgogICAgPCEtLSBNaW5hcmV0cyAobWVuYXJhKSBraXJpICYga2FuYW4gLS0+CiAgICA8IS0tIExlZnQgbWluYXJldCAtLT4KICAgIDxyZWN0IHg9Ijk2IiB5PSIyMDAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIxMzYiIHJ4PSI0IiBmaWxsPSJ1cmwoI2dvbGRHcmFkKSIvPgogICAgPGVsbGlwc2UgY3g9IjEwOCIgY3k9IjE5OCIgcng9IjE2IiByeT0iMTAiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8cGF0aCBkPSJNMTAwLDE5OCBRMTA4LDE3OCAxMTYsMTk4IFoiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8IS0tIFJpZ2h0IG1pbmFyZXQgLS0+CiAgICA8cmVjdCB4PSIzOTIiIHk9IjIwMCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjEzNiIgcng9IjQiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8ZWxsaXBzZSBjeD0iNDA0IiBjeT0iMTk4IiByeD0iMTYiIHJ5PSIxMCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgIDxwYXRoIGQ9Ik0zOTYsMTk4IFE0MDQsMTc4IDQxMiwxOTggWiIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgPC9nPgoKICA8IS0tID09PT09IFRFWFQgIk5HQUpJIFBSTyIgPT09PT0gLS0+CiAgPHRleHQgeD0iMjU2IiB5PSI0MDAiCiAgICAgICAgZm9udC1mYW1pbHk9Ikdlb3JnaWEsICdUaW1lcyBOZXcgUm9tYW4nLCBzZXJpZiIKICAgICAgICBmb250LXNpemU9IjUyIgogICAgICAgIGZvbnQtd2VpZ2h0PSI3MDAiCiAgICAgICAgbGV0dGVyLXNwYWNpbmc9IjIiCiAgICAgICAgdGV4dC1hbmNob3I9Im1pZGRsZSIKICAgICAgICBmaWxsPSJ1cmwoI2dvbGRHcmFkKSIKICAgICAgICBmaWx0ZXI9InVybCgjZ2xvdykiPk5HQUpJIFBSTzwvdGV4dD4KCiAgPCEtLSBEZWNvcmF0aXZlIGxpbmUgdW5kZXIgdGV4dCAtLT4KICA8bGluZSB4MT0iMTU2IiB5MT0iNDEyIiB4Mj0iMzU2IiB5Mj0iNDEyIiBzdHJva2U9InVybCgjZ29sZEdyYWQpIiBzdHJva2Utd2lkdGg9IjIiIG9wYWNpdHk9IjAuNiIvPgoKICA8IS0tIFRhZ2xpbmUgLS0+CiAgPHRleHQgeD0iMjU2IiB5PSI0NDAiCiAgICAgICAgZm9udC1mYW1pbHk9Ikdlb3JnaWEsIHNlcmlmIgogICAgICAgIGZvbnQtc2l6ZT0iMjAiCiAgICAgICAgbGV0dGVyLXNwYWNpbmc9IjMiCiAgICAgICAgdGV4dC1hbmNob3I9Im1pZGRsZSIKICAgICAgICBmaWxsPSIjZjllMDdhIgogICAgICAgIG9wYWNpdHk9IjAuNzUiPlRBSEZJREgg4oCiIEFCU0VOU0k8L3RleHQ+Cgo8L3N2Zz4K">
    <script>
    // Inject manifest dynamically with real logo
    (function() {
        const iconUrl = "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiI+CiAgPGRlZnM+CiAgICA8IS0tIEJhY2tncm91bmQgZ3JhZGllbnQgLS0+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImJnR3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMwYTNkMjI7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6IzFhNmIzYTtzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICA8IS0tIEdvbGQgZ3JhZGllbnQgLS0+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImdvbGRHcmFkIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNmOWUwN2E7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iNTAlIiBzdHlsZT0ic3RvcC1jb2xvcjojZTZiODMwO3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNjODkwMTA7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPCEtLSBXaGl0ZSBnbG93IC0tPgogICAgPGZpbHRlciBpZD0iZ2xvdyI+CiAgICAgIDxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjMiIHJlc3VsdD0iY29sb3JlZEJsdXIiLz4KICAgICAgPGZlTWVyZ2U+CiAgICAgICAgPGZlTWVyZ2VOb2RlIGluPSJjb2xvcmVkQmx1ciIvPgogICAgICAgIDxmZU1lcmdlTm9kZSBpbj0iU291cmNlR3JhcGhpYyIvPgogICAgICA8L2ZlTWVyZ2U+CiAgICA8L2ZpbHRlcj4KICAgIDwhLS0gU29mdCBzaGFkb3cgLS0+CiAgICA8ZmlsdGVyIGlkPSJzaGFkb3ciPgogICAgICA8ZmVEcm9wU2hhZG93IGR4PSIwIiBkeT0iNCIgc3RkRGV2aWF0aW9uPSI2IiBmbG9vZC1jb2xvcj0iIzAwMDAwMCIgZmxvb2Qtb3BhY2l0eT0iMC4zIi8+CiAgICA8L2ZpbHRlcj4KICA8L2RlZnM+CgogIDwhLS0gQmFja2dyb3VuZCByb3VuZGVkIHJlY3QgLS0+CiAgPHJlY3Qgd2lkdGg9IjUxMiIgaGVpZ2h0PSI1MTIiIHJ4PSIxMDAiIHJ5PSIxMDAiIGZpbGw9InVybCgjYmdHcmFkKSIvPgoKICA8IS0tIFN1YnRsZSBnZW9tZXRyaWMgcGF0dGVybiBvdmVybGF5IC0tPgogIDxnIG9wYWNpdHk9IjAuMDciPgogICAgPGNpcmNsZSBjeD0iMjU2IiBjeT0iMjU2IiByPSIyMDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPGNpcmNsZSBjeD0iMjU2IiBjeT0iMjU2IiByPSIxNjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPGNpcmNsZSBjeD0iMjU2IiBjeT0iMjU2IiByPSIxMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPCEtLSA4LXBvaW50IHN0YXIgcGF0dGVybiAtLT4KICAgIDxwb2x5Z29uIHBvaW50cz0iMjU2LDU2IDI3NiwyMzYgNDU2LDI1NiAyNzYsMjc2IDI1Niw0NTYgMjM2LDI3NiA1NiwyNTYgMjM2LDIzNiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIwLjgiLz4KICA8L2c+CgogIDwhLS0gPT09PT0gTUFTSklEIC8gTU9TUVVFID09PT09IC0tPgogIDxnIGZpbHRlcj0idXJsKCNzaGFkb3cpIj4KCiAgICA8IS0tIE1haW4gZG9tZSAoa3ViYWggdXRhbWEpIC0tPgogICAgPGVsbGlwc2UgY3g9IjI1NiIgY3k9IjE5NSIgcng9IjcyIiByeT0iNjgiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8cmVjdCB4PSIxODQiIHk9IjE5MyIgd2lkdGg9IjE0NCIgaGVpZ2h0PSIxMCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgICA8IS0tIENyZXNjZW50IG9uIHRvcCBvZiBtYWluIGRvbWUgLS0+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTYsIDE0MCkiPgogICAgICA8IS0tIENyZXNjZW50IG1vb24gLS0+CiAgICAgIDxjaXJjbGUgY3g9IjAiIGN5PSIwIiByPSIxNiIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgICAgPGNpcmNsZSBjeD0iOCIgY3k9Ii00IiByPSIxMyIgZmlsbD0iIzBhM2QyMiIvPgogICAgICA8IS0tIFN0YXIgLS0+CiAgICAgIDxwb2x5Z29uIHBvaW50cz0iMjIsLTE0IDI0LC04IDMwLC04IDI1LC00IDI3LDIgMjIsLTIgMTcsMiAxOSwtNCAxNCwtOCAyMCwtOCIKICAgICAgICAgICAgICAgZmlsbD0idXJsKCNnb2xkR3JhZCkiIHRyYW5zZm9ybT0ic2NhbGUoMC43KSIvPgogICAgPC9nPgoKICAgIDwhLS0gU2lkZSBkb21lcyAoa3ViYWgga2VjaWwga2lyaSAmIGthbmFuKSAtLT4KICAgIDwhLS0gTGVmdCBkb21lIC0tPgogICAgPGVsbGlwc2UgY3g9IjE3OCIgY3k9IjIzMCIgcng9IjM4IiByeT0iMzQiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8cmVjdCB4PSIxNDAiIHk9IjIyOCIgd2lkdGg9Ijc2IiBoZWlnaHQ9IjgiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CiAgICA8IS0tIExlZnQgY3Jlc2NlbnQgLS0+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzgsIDIwMCkiPgogICAgICA8Y2lyY2xlIGN4PSIwIiBjeT0iMCIgcj0iOCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgICAgPGNpcmNsZSBjeD0iNCIgY3k9Ii0yIiByPSI2LjUiIGZpbGw9IiMwYTNkMjIiLz4KICAgIDwvZz4KCiAgICA8IS0tIFJpZ2h0IGRvbWUgLS0+CiAgICA8ZWxsaXBzZSBjeD0iMzM0IiBjeT0iMjMwIiByeD0iMzgiIHJ5PSIzNCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgIDxyZWN0IHg9IjI5NiIgeT0iMjI4IiB3aWR0aD0iNzYiIGhlaWdodD0iOCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgIDwhLS0gUmlnaHQgY3Jlc2NlbnQgLS0+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMzQsIDIwMCkiPgogICAgICA8Y2lyY2xlIGN4PSIwIiBjeT0iMCIgcj0iOCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KICAgICAgPGNpcmNsZSBjeD0iNCIgY3k9Ii0yIiByPSI2LjUiIGZpbGw9IiMwYTNkMjIiLz4KICAgIDwvZz4KCiAgICA8IS0tIE1haW4gYnVpbGRpbmcgYm9keSAtLT4KICAgIDxyZWN0IHg9IjE2MCIgeT0iMjM2IiB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEwMCIgcng9IjQiIGZpbGw9InVybCgjZ29sZEdyYWQpIi8+CgogICAgPCEtLSBMZWZ0IHdpbmcgLS0+CiAgICA8cmVjdCB4PSIxMjAiIHk9IjI1NiIgd2lkdGg9IjQ0IiBoZWlnaHQ9IjgwIiByeD0iNCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgICA8IS0tIFJpZ2h0IHdpbmcgLS0+CiAgICA8cmVjdCB4PSIzNDgiIHk9IjI1NiIgd2lkdGg9IjQ0IiBoZWlnaHQ9IjgwIiByeD0iNCIgZmlsbD0idXJsKCNnb2xkR3JhZCkiLz4KCiAgICA8IS0tIE1haW4gYXJjaCAvIGRvb3IgKG1paHJhYikgLS0+CiAgICA8cGF0aCBkPSJNMjI4LDMzNiBMMjI4LDI4NSBRMjU2LDI2NSAyODQsMjg1IEwyODQsMzM2IFoiIGZpbGw9IiMwYTNkMjIiLz4KCiAgICA8IS0tIFNpZGUgYXJjaGVzIG9uIG1haW4gYm9keSAtLT4KICAgIDxwYXRoIGQ9Ik0xNzQsMzM2IEwxNzQsMjc1IFExOTEsMjYyIDIwOCwyNzUgTDIwOCwzMzYgWiIgZmlsbD0iIzBhM2QyMiIvPgogICAgPHBhdGggZD0iTTMwNCw            border: none;
            color: white;
            font-weight: 600;
            border-radius: 40px;
            padding: 0.6rem 1rem;
        }
        .btn-primary-custom:hover {
            background: #1e8449;
        }
        .btn-outline-custom {
            border: 1.5px solid #27ae60;
            color: #1e8449;
            background: white;
            border-radius: 40px;
            padding: 0.6rem 1rem;
        }
        .badge-l { background: #d5efde; color: #0b4e2e; }
        .badge-kl { background: #fef6d8; color: #9e6d0b; }

        /* grid ayat */
        .ayat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(38px, 1fr));
            gap: 5px;
            margin-top: 10px;
        }
        .ayat-item {
            height: 40px;
            line-height: 40px;
            text-align: center;
            background: #f2f9f2;
            border: 1px solid #cbe5ce;
            border-radius: 14px;
            font-weight: bold;
            font-size: 0.8rem;
            color: #14532d;
            cursor: pointer;
        }
        .ayat-item.benar { background: #dcfce7; border-color: #86efac; color: #166534; }
        .ayat-item.salah { background: #fee2e2; border-color: #fecaca; color: #991b1b; }

        /* mobile card siswa */
        .siswa-mobile-card {
            background: white;
            border-radius: 22px;
            padding: 1rem;
            margin-bottom: 12px;
            border-left: 6px solid #28a745;
            box-shadow: 0 2px 6px rgba(0,30,0,0.04);
        }
        .siswa-mobile-card.hadir { border-left-color: #28a745; }
        .siswa-mobile-card.ijin { border-left-color: #ffc107; }
        .siswa-mobile-card.sakit { border-left-color: #17a2b8; }
        .siswa-mobile-card.alpha { border-left-color: #dc3545; }

        .btn-status-group {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin: 10px 0 5px;
        }
        .btn-status {
            flex: 1 0 auto;
            border: none;
            padding: 8px 0;
            border-radius: 40px;
            font-size: 0.7rem;
            font-weight: 600;
            background: #f1f3f4;
            color: #2c3e50;
        }
        .btn-status.active {
            background: #27ae60;
            color: white;
        }
        .btn-status.hadir.active { background: #28a745; }
        .btn-status.ijin.active { background: #ffc107; color: #2c3e50; }
        .btn-status.sakit.active { background: #17a2b8; }
        .btn-status.alpha.active { background: #dc3545; }

        /* riwayat setoran - compact table */
        .tbl-setoran { width: 100%; border-collapse: collapse; font-size: 0.73rem; }
        .tbl-setoran thead tr { background: linear-gradient(135deg,#0b4e2e,#1e8449); }
        .tbl-setoran th { color:#fff; font-size:0.68rem; font-weight:700; padding:7px 6px; white-space:nowrap; }
        .tbl-setoran td { padding:6px 6px; vertical-align:middle; border-bottom:1px solid #edf7f0; color:#2c3e50; }
        .tbl-setoran tbody tr:last-child td { border-bottom:none; }
        .tbl-setoran tbody tr:hover td { background:#f0faf4; }
        .tbl-setoran .td-nama { font-weight:700; color:#1a3c28; }
        .tbl-setoran .td-surat { color:#1e8449; font-weight:600; }
        .tbl-setoran .td-tgl { color:#aaa; font-size:0.65rem; white-space:nowrap; }
        .badge-l  { background:#d5efde; color:#0b4e2e; font-size:0.62rem; border-radius:20px; padding:2px 6px; font-weight:700; white-space:nowrap; }
        .badge-kl { background:#fef6d8; color:#9e6d0b; font-size:0.62rem; border-radius:20px; padding:2px 6px; font-weight:700; white-space:nowrap; }
        .badge-err { background:#fdecea; color:#7b1829; font-size:0.62rem; border-radius:20px; padding:2px 6px; font-weight:600; }
        .badge-inf { background:#e8f4fd; color:#155e8e; font-size:0.62rem; border-radius:20px; padding:2px 6px; font-weight:600; }
        .btn-del-row { background:transparent; border:none; color:#ddd; font-size:0.82rem; cursor:pointer; padding:1px 4px; }
        .btn-del-row:hover { color:#e74c3c; }
        .setoran-empty { text-align:center; color:#bbb; padding:24px 0; font-size:0.88rem; }

        /* tab navigasi */
        .nav-tab-custom {
            display: flex;
            background: white;
            border-radius: 40px;
            padding: 4px;
            margin: 0 0 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .nav-tab-custom button {
            flex: 1;
            border: none;
            background: transparent;
            padding: 12px 0;
            border-radius: 40px;
            font-weight: 600;
            font-size: 0.85rem;
            color: #4b5563;
        }
        .nav-tab-custom button.active {
            background: #27ae60;
            color: white;
            box-shadow: 0 3px 8px rgba(39,174,96,0.3);
        }
        
        /* Container untuk swipe */
        .tabs-container {
            width: 100%;
            overflow: hidden;
        }
        
        .tabs-wrapper {
            display: flex;
            transition: transform 0.3s ease;
            width: 200%; /* 2 tab */
        }
        
        .tab-pane {
            width: 50%;
            flex-shrink: 0;
            padding: 0 2px;
        }
    </style>
</head>
<body>

    <!-- HEADER -->
    <div class="app-header text-center">
        <h1><i class="fas fa-mosque me-2"></i>NGAJI PRO</h1>
        <p>Tahfidh â€¢ Setoran â€¢ Absensi Harian</p>
        <div class="d-flex justify-content-center gap-2 mt-2 flex-wrap">
            <span class="badge bg-light text-dark px-3 py-2 rounded-pill">
                <i class="far fa-calendar me-1"></i><span id="currentDateHeader"></span>
            </span>
            <button id="btnInstall" onclick="installApp()"
                style="display:none; background:white; color:#0b4e2e; border:none; border-radius:40px; padding:6px 16px; font-weight:700; font-size:0.8rem; cursor:pointer;">
                <i class="fas fa-download me-1"></i> Pasang ke HP
            </button>
        </div>
    </div>

    <!-- Banner panduan install -->
    <div id="bannerInstall" style="display:none; background:#fff3cd; border-left:5px solid #ffc107; margin:0 8px 12px; border-radius:16px; padding:12px 16px; font-size:0.82rem; color:#664d03; position:relative;">
        <b><i class="fas fa-mobile-alt me-1"></i> Pasang aplikasi ke layar utama HP:</b><br>
        <span id="guideChrome">Tap tombol <b>"Pasang ke HP"</b> di header atas â†‘</span>
        <span id="guideOther" style="display:none">Tap <b>â‹® menu</b> browser kamu â†’ <b>"Tambahkan ke layar utama"</b></span>
        <button onclick="document.getElementById('bannerInstall').style.display='none'"
            style="position:absolute; top:8px; right:12px; background:none; border:none; font-size:1.1rem; cursor:pointer; color:#664d03;">âœ•</button>
    </div>

    <div class="container px-2">
        <!-- navigasi tab (tetap ada untuk klik) -->
        <div class="nav-tab-custom">
            <button id="tabTahfidhBtn" class="active" onclick="switchTab('tahfidh')">
                <i class="fas fa-book-open me-1"></i> Setoran
            </button>
            <button id="tabAbsensiBtn" onclick="switchTab('absensi')">
                <i class="fas fa-users me-1"></i> Absensi
            </button>
        </div>

        <!-- Container dengan swipe -->
        <div class="tabs-container" id="tabsContainer">
            <div class="tabs-wrapper" id="tabsWrapper">
                <!-- ============= TAB TAHFIDH ============= -->
                <div id="tabTahfidh" class="tab-pane">
                    <div class="card">
                        <div class="card-header"><i class="fas fa-upload"></i> Import Data Siswa</div>
                        <div class="card-body">
                            <label class="fw-semibold mb-1 small">ðŸ“¥ Upload Excel (kolom A = Nama Siswa)</label>
                            <input type="file" id="uploadExcel" accept=".xlsx, .xls" class="form-control form-control-sm mb-2">
                            <button class="btn btn-primary-custom w-100" onclick="importNama()">
                                <i class="fas fa-upload me-1"></i> Import Nama
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header"><i class="fas fa-pen-alt"></i> Form Tahfidh</div>
                        <div class="card-body">
                            <div class="row g-2 mb-2">
                                <div class="col-12">
                                    <label class="fw-semibold small">Pilih Siswa</label>
                                    <select id="namaSiswa" class="form-select form-select-sm"></select>
                                </div>
                            </div>
                            <div class="row g-2 mb-2">
                                <div class="col-6">
                                    <label class="fw-semibold small">Surat</label>
                                    <select id="surat" class="form-select form-select-sm" onchange="renderAyatList()"></select>
                                </div>
                                <div class="col-3">
                                    <label class="fw-semibold small">Mulai</label>
                                    <select id="ayatMulai" class="form-select form-select-sm" onchange="renderAyatGrid()"></select>
                                </div>
                                <div class="col-3">
                                    <label class="fw-semibold small">Sampai</label>
                                    <select id="ayatSampai" class="form-select form-select-sm" onchange="renderAyatGrid()"></select>
                                </div>
                            </div>
                            
                            <div class="row g-2 mb-2">
                                <div class="col-6">
                                    <label class="fw-semibold small">Status</label>
                                    <select id="statusLancar" class="form-select form-select-sm">
                                        <option value="L">L (Lancar)</option>
                                        <option value="KL">KL (Kurang Lancar)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="bg-light p-2 rounded-4 mb-2">
                                <label class="fw-semibold small">Keterangan Tambahan:</label>
                                <div class="d-flex flex-wrap gap-3">
                                    <label class="small"><input type="checkbox" class="opt-tambah me-1" value="Belum Khatam"> Belum Khatam</label>
                                    <label class="small"><input type="checkbox" class="opt-tambah me-1" value="Muroja'ah"> Muroja'ah</label>
                                    <label class="small"><input type="checkbox" class="opt-tambah me-1" value="Tasmi'"> Tasmi'</label>
                                </div>
                            </div>

                            <div class="bg-danger bg-opacity-10 p-2 rounded-4 mb-2">
                                <label class="fw-semibold small">Evaluasi Kesalahan:</label>
                                <div id="ayatGrid" class="ayat-grid mt-2"></div>
                                <small class="text-muted">*Klik nomor ayat yang salah</small>
                                <hr class="my-2" style="border-color: rgba(220,53,69,0.25);">
                                <div class="d-flex flex-wrap gap-3">
                                    <label class="small"><input type="checkbox" class="cat-salah me-1" value="Tajwid"> Tajwid</label>
                                    <label class="small"><input type="checkbox" class="cat-salah me-1" value="P.Pendek"> Panjang Pendek</label>
                                    <label class="small"><input type="checkbox" class="cat-salah me-1" value="Makhraj"> Makhraj</label>
                                </div>
                            </div>

                            <div class="d-flex gap-2 mt-2">
                                <button class="btn btn-primary-custom flex-fill" onclick="tambahDataSetoran()">
                                    <i class="fas fa-save me-1"></i> Simpan Rekap
                                </button>
                                <button class="btn btn-outline-custom flex-fill" onclick="resetFormSetoran()">
                                    Reset
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span><i class="fas fa-history"></i> Riwayat Setoran</span>
                            <span class="badge bg-success rounded-pill" id="totalSetoran">0</span>
                        </div>
                        <div class="card-body p-0" id="riwayatSetoranList">
                            <table class="tbl-setoran">
                                <thead>
                                    <tr>
                                        <th>Nama</th>
                                        <th>Surat & Ayat</th>
                                        <th>Status</th>
                                        <th>Ket</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="riwayatSetoranTbody"></tbody>
                            </table>
                            <div id="riwayatSetoranEmpty" class="setoran-empty d-none">
                                <i class="fas fa-inbox fa-2x mb-2 d-block"></i>Belum ada setoran
                            </div>
                        </div>
                        <div class="card-footer bg-white border-0 pb-2 pt-1">
                            <button class="btn btn-primary-custom w-100" onclick="downloadExcelSetoran()">
                                <i class="fas fa-download me-2"></i>Download Laporan Tahfidh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ============= TAB ABSENSI ============= -->
                <div id="tabAbsensi" class="tab-pane">
                    <div class="card">
                        <div class="card-header"><i class="fas fa-upload"></i> Upload Daftar siswa</div>
                        <div class="card-body">
                            <label class="fw-semibold mb-1 small">ðŸ“¥ Upload Excel (kolom: No, Nama, Kelas)</label>
                            <input type="file" class="form-control mb-2" id="fileInputAbsensi" accept=".xlsx, .xls, .csv">
                            <div class="d-flex gap-2">
                                <button class="btn btn-primary-custom flex-fill" onclick="uploadExcelAbsensi()">
                                    <i class="fas fa-upload me-1"></i> Upload
                                </button>
                                <button class="btn btn-outline-custom flex-fill" onclick="downloadTemplateAbsensi()">
                                    <i class="fas fa-download me-1"></i> Template
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Statistik -->
                    <div class="row g-2 mb-2">
                        <div class="col-3">
                            <div class="bg-white p-2 rounded-4 text-center">
                                <h4 class="mb-0 text-success" id="totalHadir">0</h4>
                                <small>Hadir</small>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="bg-white p-2 rounded-4 text-center">
                                <h4 class="mb-0 text-warning" id="totalIjin">0</h4>
                                <small>Ijin</small>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="bg-white p-2 rounded-4 text-center">
                                <h4 class="mb-0 text-info" id="totalSakit">0</h4>
                                <small>Sakit</small>
                            </div>
                        </div>
                        <div class="col-3">
                            <div class="bg-white p-2 rounded-4 text-center">
                                <h4 class="mb-0 text-danger" id="totalAlpha">0</h4>
                                <small>Alpha</small>
                            </div>
                        </div>
                    </div>

                    <!-- Daftar siswa Mobile Cards -->
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span><i class="fas fa-users me-2"></i>siswa</span>
                            <button class="btn btn-sm btn-outline-success rounded-pill" onclick="sortByNameAbsensi()">
                                <i class="fas fa-sort-alpha-down"></i>
                            </button>
                        </div>
                        <div class="card-body p-2" id="mobileCardView">
                            <div class="text-center text-muted py-4">
                                <i class="fas fa-cloud-upload-alt fa-2x mb-2"></i><br>Upload Excel terlebih dahulu
                            </div>
                        </div>
                    </div>

                    <!-- Riwayat Absensi -->
                    <div class="card">
                        <div class="card-header"><i class="fas fa-clock"></i> Riwayat Absensi Hari Ini</div>
                        <div class="card-body p-2" id="riwayatContainer">
                            <p class="text-muted small text-center py-2">Belum ada data</p>
                        </div>
                    </div>

                    <!-- Tombol Aksi -->
                    <div class="d-flex gap-2 mt-2 mb-3">
                        <button class="btn btn-primary-custom flex-fill" onclick="simpanAbsensi()">
                            <i class="fas fa-save me-1"></i> Simpan Excel
                        </button>
                        <button class="btn btn-outline-danger flex-fill" onclick="resetDataAbsensi()">
                            <i class="fas fa-trash-alt me-1"></i> Reset
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== DATA GLOBAL ====================
        let listSiswa = JSON.parse(localStorage.getItem('db_siswa_final')) || [];
        let dataSetoran = JSON.parse(localStorage.getItem('db_absen_final')) || [];
        
        // Data absensi
        let datasiswaAbsensi = [];
        let absensiData = [];

        // Variabel untuk swipe
        let touchStartX = 0;
        let touchEndX = 0;
        let currentTab = 'tahfidh'; // tahfidh atau absensi

        // Format tanggal
        function formatTanggal() {
            const d = new Date();
            const days = ['Minggu','Senin','Selasa','Rabu','Kamis','Jumat','Sabtu'];
            const months = ['Januari','Februari','Maret','April','Mei','Juni','Juli','Agustus','September','Oktober','November','Desember'];
            return `${days[d.getDay()]}, ${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;
        }
        document.getElementById('currentDateHeader').innerText = formatTanggal();

        // ==================== FUNGSI SWIPE ====================
        function initSwipe() {
            const container = document.getElementById('tabsContainer');
            
            container.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            }, {passive: true});
            
            container.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }, {passive: true});
        }

        function handleSwipe() {
            const swipeThreshold = 50; // minimal jarak swipe
            const diff = touchEndX - touchStartX;
            
            if (Math.abs(diff) < swipeThreshold) return;
            
            if (diff > 0) {
                // Swipe kanan -> pindah ke tab kiri (Tahfidh)
                if (currentTab === 'absensi') {
                    switchTab('tahfidh');
                }
            } else {
                // Swipe kiri -> pindah ke tab kanan (Absensi)
                if (currentTab === 'tahfidh') {
                    switchTab('absensi');
                }
            }
        }

        function updateTabPosition(tab) {
            const wrapper = document.getElementById('tabsWrapper');
            if (tab === 'tahfidh') {
                wrapper.style.transform = 'translateX(0)';
            } else {
                wrapper.style.transform = 'translateX(-50%)';
            }
            
            // Update active class pada tombol navigasi
            document.getElementById('tabTahfidhBtn').classList.toggle('active', tab === 'tahfidh');
            document.getElementById('tabAbsensiBtn').classList.toggle('active', tab === 'absensi');
        }

        // ==================== TAB SWITCH ====================
        function switchTab(tab) {
            currentTab = tab;
            updateTabPosition(tab);
            
            if (tab === 'absensi') {
                renderMobileCards();
            }
        }

        // ==================== TAHFIDH / SETORAN ====================
        const daftarSurat = [
            {no:78, nama:"An-Naba'", ayat:40}, {no:79, nama:"An-Nazi'at", ayat:46},
            {no:80, nama:"'Abasa", ayat:42}, {no:81, nama:"At-Takwir", ayat:29},
            {no:82, nama:"Al-Infitar", ayat:19}, {no:83, nama:"Al-Mutaffifin", ayat:36},
            {no:84, nama:"Al-Inshiqaq", ayat:25}, {no:85, nama:"Al-Buruj", ayat:22},
            {no:86, nama:"At-Tariq", ayat:17}, {no:87, nama:"Al-A'la", ayat:19},
            {no:88, nama:"Al-Ghashiyah", ayat:26}, {no:89, nama:"Al-Fajr", ayat:30},
            {no:90, nama:"Al-Balad", ayat:20}, {no:91, nama:"Ash-Shams", ayat:15},
            {no:92, nama:"Al-Layl", ayat:21}, {no:93, nama:"Ad-Duha", ayat:11},
            {no:94, nama:"Ash-Sharh", ayat:8}, {no:95, nama:"At-Tin", ayat:8},
            {no:96, nama:"Al-'Alaq", ayat:19}, {no:97, nama:"Al-Qadr", ayat:5},
            {no:98, nama:"Al-Bayyinah", ayat:8}, {no:99, nama:"Az-Zalzalah", ayat:8},
            {no:100, nama:"Al-'Adiyat", ayat:11}, {no:101, nama:"Al-Qari'ah", ayat:11},
            {no:102, nama:"At-Takathur", ayat:8}, {no:103, nama:"Al-'Asr", ayat:3},
            {no:104, nama:"Al-Humazah", ayat:9}, {no:105, nama:"Al-Fil", ayat:5},
            {no:106, nama:"Quraish", ayat:4}, {no:107, nama:"Al-Ma'un", ayat:7},
            {no:108, nama:"Al-Kawthar", ayat:3}, {no:109, nama:"Al-Kafirun", ayat:6},
            {no:110, nama:"An-Nasr", ayat:3}, {no:111, nama:"Al-Masad", ayat:5},
            {no:112, nama:"Al-Ikhlas", ayat:4}, {no:113, nama:"Al-Falaq", ayat:5},
            {no:114, nama:"An-Nas", ayat:6}
        ];

        // Isi dropdown surat
        const selSurat = document.getElementById('surat');
        daftarSurat.forEach(s => selSurat.add(new Option(`${s.no}. ${s.nama}`, s.nama)));

        function renderNamaList() {
            const select = document.getElementById('namaSiswa');
            select.innerHTML = '<option value="">-- Pilih Siswa --</option>';
            listSiswa.forEach(n => select.add(new Option(n, n)));
        }

        function renderAyatList() {
            const s = daftarSurat.find(x => x.nama === document.getElementById('surat').value);
            if (!s) return;
            const mulai = document.getElementById('ayatMulai');
            const sampai = document.getElementById('ayatSampai');
            mulai.innerHTML = ''; sampai.innerHTML = '';
            for (let i = 1; i <= s.ayat; i++) {
                mulai.add(new Option(i, i));
                sampai.add(new Option(i, i));
            }
            sampai.value = s.ayat;
            renderAyatGrid();
        }

        function renderAyatGrid() {
            const grid = document.getElementById('ayatGrid');
            const start = parseInt(document.getElementById('ayatMulai').value) || 1;
            const end = parseInt(document.getElementById('ayatSampai').value) || 1;
            grid.innerHTML = '';
            for (let i = start; i <= end; i++) {
                let d = document.createElement('div');
                d.className = 'ayat-item benar';
                d.innerText = i;
                d.onclick = () => { d.classList.toggle('salah'); d.classList.toggle('benar'); };
                grid.appendChild(d);
            }
        }

        // IMPORT EXCEL UNTUK TAHFIDH (kolom A = Nama)
        function importNama() {
            const file = document.getElementById('uploadExcel').files[0];
            if (!file) return alert('Pilih file Excel terlebih dahulu!');
            
            const reader = new FileReader();
            reader.onload = (event) => {
                try {
                    const data = new Uint8Array(event.target.result);
                    const wb = XLSX.read(data, {type: 'array'});
                    const sheet = wb.Sheets[wb.SheetNames[0]];
                    const rows = XLSX.utils.sheet_to_json(sheet, {header: 1});
                    
                    // Ambil kolom A (index 0) sebagai nama
                    const namaList = [];
                    for (let i = 0; i < rows.length; i++) {
                        if (rows[i] && rows[i][0] && typeof rows[i][0] === 'string') {
                            const nama = rows[i][0].trim();
                            if (nama && !nama.toLowerCase().includes('nama') && !nama.toLowerCase().includes('no')) {
                                namaList.push(nama);
                            }
                        }
                    }
                    
                    if (namaList.length === 0) {
                        alert('Tidak menemukan data nama di kolom A');
                        return;
                    }
                    
                    listSiswa = [...new Set(namaList)].sort();
                    localStorage.setItem('db_siswa_final', JSON.stringify(listSiswa));
                    renderNamaList();
                    
                    alert(`Berhasil mengimport ${listSiswa.length} siswa`);
                    
                } catch (error) {
                    alert('Error membaca file: ' + error.message);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function tambahDataSetoran() {
            const nama = document.getElementById('namaSiswa').value;
            if (!nama) return alert("Pilih Nama Siswa!");
            
            const ayatSalah = Array.from(document.querySelectorAll('.ayat-item.salah')).map(el => el.innerText);
            const optTambahan = Array.from(document.querySelectorAll('.opt-tambah:checked')).map(el => el.value);
            const catSalah = Array.from(document.querySelectorAll('.cat-salah:checked')).map(el => el.value);

            const record = {
                id: Date.now(),
                tgl: new Date().toLocaleDateString('id-ID'),
                nama: nama,
                surat: document.getElementById('surat').value,
                rentang: `${document.getElementById('ayatMulai').value}-${document.getElementById('ayatSampai').value}`,
                stat: document.getElementById('statusLancar').value,
                salah: ayatSalah.join(', ') || '-',
                jml: ayatSalah.length,
                tambahan: optTambahan.join(', ') || '-',
                kategori: catSalah.join(', ') || '-'
            };

            dataSetoran.unshift(record);
            localStorage.setItem('db_absen_final', JSON.stringify(dataSetoran));
            updateTabelSetoran();
            resetFormSetoran();
        }

        function updateTabelSetoran() {
            const tbody = document.getElementById('riwayatSetoranTbody');
            const badge = document.getElementById('totalSetoran');
            const emptyEl = document.getElementById('riwayatSetoranEmpty');
            if (!tbody) return;

            if (badge) badge.innerText = dataSetoran.length;

            if (dataSetoran.length === 0) {
                tbody.innerHTML = '';
                if (emptyEl) emptyEl.classList.remove('d-none');
                return;
            }
            if (emptyEl) emptyEl.classList.add('d-none');

            tbody.innerHTML = dataSetoran.map(i => {
                const isKL = i.stat === 'KL';

                // Kolom Ket: kategori salah & ayat salah
                let ket = [];
                if (i.jml > 0) ket.push(`<span style="font-size:0.68rem;color:#c0392b">${i.jml} salah${i.kategori !== '-' ? ' Â· ' + i.kategori : ''}</span>`);
                if (i.salah && i.salah !== '-') ket.push(`<span style="font-size:0.62rem;color:#c0392b">Ayat: ${i.salah}</span>`);

                // Tambahan di bawah nama
                const tambahanHtml = (i.tambahan && i.tambahan !== '-')
                    ? `<div style="margin-top:2px">${i.tambahan.split(',').map(t => `<span class="badge-inf">${t.trim()}</span>`).join(' ')}</div>`
                    : '';

                return `<tr>
                    <td>
                        <div class="td-nama">${i.nama}</div>
                        <div class="td-tgl">${i.tgl}</div>
                        ${tambahanHtml}
                    </td>
                    <td>
                        <div class="td-surat">${i.surat}</div>
                        <div style="font-size:0.68rem;color:#555">${i.rentang}</div>
                    </td>
                    <td><span class="${isKL ? 'badge-kl' : 'badge-l'}">${isKL ? 'KL' : 'L'}</span></td>
                    <td>${ket.join('<br>') || '<span style="color:#ccc;font-size:0.65rem">â€”</span>'}</td>
                    <td><button class="btn-del-row" onclick="hapusSetoran('${i.id}')"><i class="fas fa-times"></i></button></td>
                </tr>`;
            }).join('');
        }

        window.hapusSetoran = function(id) {
            if (confirm('Hapus data ini?')) {
                dataSetoran = dataSetoran.filter(x => x.id != id);
                localStorage.setItem('db_absen_final', JSON.stringify(dataSetoran));
                updateTabelSetoran();
            }
        }

        function resetFormSetoran() {
            document.querySelectorAll('.cat-salah, .opt-tambah').forEach(el => el.checked = false);
            renderAyatGrid();
        }

        function downloadExcelSetoran() {
            if (dataSetoran.length === 0) return alert('Belum ada data setoran');

            // Ambil kelas unik dari data absensi jika tersedia, atau dari nama siswa di setoran
            let kelasSuffix = '';
            if (datasiswaAbsensi.length > 0) {
                const kelasUnik = [...new Set(datasiswaAbsensi.map(s => s.kelas).filter(Boolean))];
                if (kelasUnik.length > 0) kelasSuffix = '_' + kelasUnik.join('-').replace(/\s+/g, '');
            }

            const ws = XLSX.utils.json_to_sheet(dataSetoran);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Setoran");
            XLSX.writeFile(wb, `Setoran_Tahfidh${kelasSuffix}_${new Date().toISOString().slice(0,10)}.xlsx`);
        }

        // ==================== ABSENSI ====================
        function downloadTemplateAbsensi() {
            const template = [
                ['No', 'Nama', 'Kelas'],
                ['1', 'Ahmad Hasan', 'Tahfidh 1'],
                ['2', 'Bella Safira', 'Tahfidh 2'],
                ['3', 'Chandra Wijaya', 'Tahsin 1']
            ];
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(template);
            XLSX.utils.book_append_sheet(wb, ws, "Template");
            XLSX.writeFile(wb, "template_absensi_siswa.xlsx");
        }

        function uploadExcelAbsensi() {
            const file = document.getElementById('fileInputAbsensi').files[0];
            if (!file) return alert('Pilih file Excel terlebih dahulu!');
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const wb = XLSX.read(data, {type: 'array'});
                    const sheet = wb.Sheets[wb.SheetNames[0]];
                    const rows = XLSX.utils.sheet_to_json(sheet, {header: 1});
                    
                    datasiswaAbsensi = [];
                    
                    // Mulai dari baris 1 (abaikan header jika ada)
                    for (let i = 1; i < rows.length; i++) {
                        const row = rows[i];
                        if (row && row.length >= 2) {
                            // Kolom: No (opsional), Nama, Kelas
                            const nama = row[1] ? row[1].toString().trim() : '';
                            const kelas = row[2] ? row[2].toString().trim() : 'Umum';
                            
                            if (nama && !nama.toLowerCase().includes('nama')) {
                                datasiswaAbsensi.push({
                                    no: i,
                                    nama: nama,
                                    kelas: kelas
                                });
                            }
                        }
                    }
                    
                    if (datasiswaAbsensi.length === 0) {
                        alert('Tidak menemukan data siswa. Pastikan kolom B berisi Nama dan kolom C berisi Kelas');
                        return;
                    }
                    
                    // Inisialisasi status HADIR sebagai default
                    const now = new Date().toLocaleTimeString('id-ID', {hour: '2-digit', minute: '2-digit'});
                    absensiData = datasiswaAbsensi.map(s => ({
                        ...s,
                        status: 'Hadir',
                        waktu: now
                    }));
                    
                    renderMobileCards();
                    updateStatistikAbsensi();
                    updateRiwayatAbsensi();
                    alert(`Berhasil mengimport ${datasiswaAbsensi.length} siswa (default: Hadir)`);
                    
                } catch (error) {
                    alert('Error membaca file: ' + error.message);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function renderMobileCards() {
            const container = document.getElementById('mobileCardView');
            if (!datasiswaAbsensi.length) {
                container.innerHTML = '<div class="text-center text-muted py-4"><i class="fas fa-cloud-upload-alt fa-2x mb-2"></i><br>Upload Excel terlebih dahulu</div>';
                return;
            }

            let html = '';
            datasiswaAbsensi.forEach(s => {
                const abs = absensiData.find(a => a.nama === s.nama) || {status: 'Hadir', waktu: new Date().toLocaleTimeString('id-ID', {hour:'2-digit',minute:'2-digit'})};
                const statusLower = abs.status.toLowerCase();
                
                let statusBadgeClass = '';
                if (abs.status === 'Hadir') statusBadgeClass = 'bg-success text-white';
                else if (abs.status === 'Ijin') statusBadgeClass = 'bg-warning';
                else if (abs.status === 'Sakit') statusBadgeClass = 'bg-info text-white';
                else statusBadgeClass = 'bg-secondary text-white';
                
                html += `
                    <div class="siswa-mobile-card ${statusLower}">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <span class="fw-bold">${s.nama}</span>
                                <span class="badge bg-light text-dark ms-2">${s.kelas}</span>
                            </div>
                            <span class="badge ${statusBadgeClass}">${abs.status}</span>
                        </div>
                        
                        <div class="btn-status-group mt-2">
                            <button class="btn-status hadir ${abs.status === 'Hadir' ? 'active' : ''}" 
                                onclick="ubahStatusAbsensi('${s.nama}','Hadir')">
                                <i class="fas fa-check-circle"></i> Hadir
                            </button>
                            <button class="btn-status ijin ${abs.status === 'Ijin' ? 'active' : ''}" 
                                onclick="ubahStatusAbsensi('${s.nama}','Ijin')">
                                <i class="fas fa-file-signature"></i> Ijin
                            </button>
                            <button class="btn-status sakit ${abs.status === 'Sakit' ? 'active' : ''}" 
                                onclick="ubahStatusAbsensi('${s.nama}','Sakit')">
                                <i class="fas fa-thermometer-half"></i> Sakit
                            </button>
                            <button class="btn-status alpha ${abs.status === 'Alpha' ? 'active' : ''}" 
                                onclick="ubahStatusAbsensi('${s.nama}','Alpha')">
                                <i class="fas fa-times-circle"></i> Alpha
                            </button>
                        </div>
                        
                        ${abs.waktu ? `<div class="small text-muted mt-1"><i class="far fa-clock me-1"></i>${abs.waktu}</div>` : ''}
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        window.ubahStatusAbsensi = function(nama, status) {
            const idx = absensiData.findIndex(a => a.nama === nama);
            const now = new Date().toLocaleTimeString('id-ID', {hour: '2-digit', minute: '2-digit'});
            
            if (idx >= 0) {
                absensiData[idx].status = status;
                absensiData[idx].waktu = now;
            } else {
                const siswa = datasiswaAbsensi.find(s => s.nama === nama);
                if (siswa) {
                    absensiData.push({...siswa, status, waktu: now});
                }
            }
            
            renderMobileCards();
            updateStatistikAbsensi();
            updateRiwayatAbsensi();
        };

        function updateStatistikAbsensi() {
            const hadir = absensiData.filter(a => a.status === 'Hadir').length;
            const ijin = absensiData.filter(a => a.status === 'Ijin').length;
            const sakit = absensiData.filter(a => a.status === 'Sakit').length;
            const alpha = absensiData.filter(a => a.status === 'Alpha').length;
            
            document.getElementById('totalHadir').innerText = hadir;
            document.getElementById('totalIjin').innerText = ijin;
            document.getElementById('totalSakit').innerText = sakit;
            document.getElementById('totalAlpha').innerText = alpha;
        }

        function updateRiwayatAbsensi() {
            const container = document.getElementById('riwayatContainer');
            const absenHariIni = absensiData.filter(a => a.status !== 'Alpha' && a.waktu);
            
            if (absenHariIni.length === 0) {
                container.innerHTML = '<p class="text-muted small text-center py-2">Belum ada absensi</p>';
                return;
            }
            
            let html = '';
            absenHariIni.slice(0, 5).forEach(a => {
                let statusClass = a.status === 'Hadir' ? 'success' : a.status === 'Ijin' ? 'warning' : 'info';
                html += `
                    <div class="d-flex justify-content-between align-items-center border-bottom py-1">
                        <span>
                            <i class="fas fa-circle text-${statusClass} me-1 small"></i>
                            ${a.nama}
                        </span>
                        <span class="badge bg-light text-dark">${a.waktu}</span>
                    </div>
                `;
            });
            
            if (absenHariIni.length > 5) {
                html += `<div class="text-muted small text-center mt-1">... dan ${absenHariIni.length - 5} lainnya</div>`;
            }
            
            container.innerHTML = html;
        }

        function sortByNameAbsensi() {
            if (!datasiswaAbsensi.length) return;

            // Gabungkan status terkini ke datasiswaAbsensi sebelum sort
            datasiswaAbsensi = datasiswaAbsensi.map(s => {
                const abs = absensiData.find(a => a.nama === s.nama);
                return abs ? {...s, _status: abs.status, _waktu: abs.waktu} : {...s, _status: 'Hadir', _waktu: ''};
            });

            // Urutkan berdasarkan nama A-Z (locale Indonesia)
            datasiswaAbsensi.sort((a, b) => a.nama.localeCompare(b.nama, 'id', {sensitivity: 'base'}));

            // Rebuild absensiData sesuai urutan baru
            absensiData = datasiswaAbsensi.map(s => ({
                no: s.no,
                nama: s.nama,
                kelas: s.kelas,
                status: s._status || 'Hadir',
                waktu: s._waktu || ''
            }));

            renderMobileCards();
        }

        function simpanAbsensi() {
            if (!datasiswaAbsensi.length) return alert('Tidak ada data absensi');
            
            const hadir = absensiData.filter(a => a.status === 'Hadir').length;
            const ijin = absensiData.filter(a => a.status === 'Ijin').length;
            const sakit = absensiData.filter(a => a.status === 'Sakit').length;
            const alpha = absensiData.filter(a => a.status === 'Alpha').length;
            
            const wsData = [
                ['LAPORAN ABSENSI MENGAJI'],
                ['Tanggal', formatTanggal()],
                ['Total siswa', datasiswaAbsensi.length],
                ['Hadir', hadir],
                ['Ijin', ijin],
                ['Sakit', sakit],
                ['Alpha', alpha],
                [],
                ['No', 'Nama', 'Kelas', 'Status', 'Waktu']
            ];
            
            absensiData.forEach((a, i) => {
                wsData.push([i + 1, a.nama, a.kelas, a.status, a.waktu || '-']);
            });
            
            // Ambil kelas unik dari data siswa
            const kelasUnik = [...new Set(datasiswaAbsensi.map(s => s.kelas).filter(Boolean))];
            const kelasSuffix = kelasUnik.length > 0 ? '_' + kelasUnik.join('-').replace(/\s+/g, '') : '';

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(wb, ws, "Absensi");
            XLSX.writeFile(wb, `absensi${kelasSuffix}_${new Date().toISOString().slice(0,10)}.xlsx`);
        }

        function resetDataAbsensi() {
            if (confirm('Reset semua data absensi?')) {
                datasiswaAbsensi = [];
                absensiData = [];
                document.getElementById('fileInputAbsensi').value = '';
                renderMobileCards();
                updateStatistikAbsensi();
                document.getElementById('riwayatContainer').innerHTML = '<p class="text-muted small text-center py-2">Belum ada data</p>';
            }
        }

        // ==================== INITIAL RENDER ====================
        renderNamaList();
        renderAyatList();
        updateTabelSetoran();
        
        // Inisialisasi swipe
        initSwipe();

        // ==================== PWA INSTALL LOGIC ====================
        let deferredPrompt = null;

        // Cek apakah sudah berjalan sebagai PWA standalone
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches
            || window.navigator.standalone === true;

        if (!isStandalone) {
            setTimeout(() => {
                document.getElementById('bannerInstall').style.display = 'block';
                const isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
                if (!isChrome) {
                    document.getElementById('guideChrome').style.display = 'none';
                    document.getElementById('guideOther').style.display = 'inline';
                }
            }, 2000);
        }

        // Tangkap event beforeinstallprompt (Chrome Android)
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('btnInstall').style.display = 'inline-block';
        });

        // Tombol "Pasang ke HP"
        window.installApp = async function() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    document.getElementById('btnInstall').style.display = 'none';
                    document.getElementById('bannerInstall').style.display = 'none';
                }
                deferredPrompt = null;
            } else {
                alert('Untuk memasang aplikasi:\nTap menu \u22ee di browser kamu\nlalu pilih "Tambahkan ke layar utama"');
            }
        };

        window.addEventListener('appinstalled', () => {
            document.getElementById('btnInstall').style.display = 'none';
            document.getElementById('bannerInstall').style.display = 'none';
        });

        // Service Worker untuk bisa dibuka offline
        if ('serviceWorker' in navigator) {
            const swCode = `
                const CACHE_NAME = 'ngaji-pro-v1';
                self.addEventListener('install', e => self.skipWaiting());
                self.addEventListener('activate', e => e.waitUntil(self.clients.claim()));
                self.addEventListener('fetch', e => {
                    e.respondWith(
                        fetch(e.request).catch(() => caches.match(e.request))
                    );
                });
            `;
            try {
                const blob = new Blob([swCode], {type: 'application/javascript'});
                const swUrl = URL.createObjectURL(blob);
                navigator.serviceWorker.register(swUrl, {scope: '/'}).catch(()=>{});
            } catch(e) {}
        }
    </script>
</body>
</html>
